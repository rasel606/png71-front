{"ast":null,"code":"// // hooks/useRefreshBalance.js\n// import { useState, useEffect } from 'react';\n// import axios from 'axios';\n// import { UserAllDetails } from '../Component/Axios-API-Service/AxiosAPIService';\n// import { useAuth } from '../Component/AuthContext';\n// export const useRefreshBalance = () => {\n//   const [balance, setBalance] = useState(0);\n//   const [refreshing, setRefreshing] = useState(false);\n//   const { userDeatils } = useAuth();\n//   const userBalance = userDeatils ? userDeatils.balance : \"\";\n//   useEffect(() => {\n//     setBalance(userBalance);\n//   }, [userBalance]);\n//   const handleRefresh = async (userId) => {\n//     if (!userId) return;\n//     setRefreshing(true);\n//     try {\n//       await handelUserDetails(userId);\n//       const response = await fetch.post(\n//         \"http://localhost:5000/api/v1/user_balance\",\n//         { userId }\n//       );\n//       setBalance(response.data.balance);\n//       console.log(\"Balance Data:\", response.data);\n//     } catch (error) {\n//       console.error(\"Error fetching balance:\", error);\n//     } finally {\n//       setRefreshing(false);\n//     }\n//   };\n//   const handelUserDetails = async (userId) => {\n//     const result = await UserAllDetails(userId);\n//     setBalance(result.data.user.balance);\n//   };\n//   return {\n//     balance,\n//     refreshing,\n//     handleRefresh,\n//     setBalance\n//   };\n// };\n// hooks/useRefreshBalance.js\nimport{useState,useEffect}from\"react\";import{useAuth}from\"../contexts/AuthContext\";export const useRefreshBalance=()=>{const[balance,setBalance]=useState(null);const[refreshing,setRefreshing]=useState(false);const{userDetails}=useAuth();// ✅ fixed typo\n// Sync initial balance from AuthContext\nuseEffect(()=>{if((userDetails===null||userDetails===void 0?void 0:userDetails.balance)!==undefined){setBalance(userDetails.balance);}},[userDetails]);// ✅ Refresh balance manually\nconst handleRefresh=async userId=>{if(!userId)return;setRefreshing(true);try{// Optional: update local balance from user detail endpoint\n//   await handleUserDetails(userId);\n// Fetch latest balance directly\nconst response=await fetch(\"http://localhost:5000/api/v1/user_balance\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({userId})});if(!response.ok)throw new Error(\"Network response was not ok\");const data=await response.json();if((data===null||data===void 0?void 0:data.balance)!==undefined){setBalance(data.balance);console.log(\"Balance Data:\",data);}}catch(error){console.error(\"Error fetching balance:\",error);}finally{setRefreshing(false);}};// ✅ Fetch user details balance\n//   const handleUserDetails = async (userId) => {\n//     try {\n//       const result = await UserAllDetails(userId); // assuming this still uses fetch or internal API call\n//       if (result?.data?.user?.balance !== undefined) {\n//         setBalance(result.data.user.balance);\n//       }\n//     } catch (err) {\n//       console.error(\"Error fetching user details:\", err);\n//     }\n//   };\nreturn{balance,refreshing,handleRefresh,setBalance};};","map":{"version":3,"names":["useState","useEffect","useAuth","useRefreshBalance","balance","setBalance","refreshing","setRefreshing","userDetails","undefined","handleRefresh","userId","response","fetch","method","headers","body","JSON","stringify","ok","Error","data","json","console","log","error"],"sources":["F:/png71/my-app/src/hooks/useRefreshBalance.js"],"sourcesContent":["// // hooks/useRefreshBalance.js\r\n// import { useState, useEffect } from 'react';\r\n// import axios from 'axios';\r\n// import { UserAllDetails } from '../Component/Axios-API-Service/AxiosAPIService';\r\n// import { useAuth } from '../Component/AuthContext';\r\n\r\n// export const useRefreshBalance = () => {\r\n//   const [balance, setBalance] = useState(0);\r\n//   const [refreshing, setRefreshing] = useState(false);\r\n//   const { userDeatils } = useAuth();\r\n  \r\n//   const userBalance = userDeatils ? userDeatils.balance : \"\";\r\n\r\n//   useEffect(() => {\r\n//     setBalance(userBalance);\r\n//   }, [userBalance]);\r\n\r\n//   const handleRefresh = async (userId) => {\r\n//     if (!userId) return;\r\n    \r\n//     setRefreshing(true);\r\n//     try {\r\n//       await handelUserDetails(userId);\r\n//       const response = await fetch.post(\r\n//         \"http://localhost:5000/api/v1/user_balance\",\r\n//         { userId }\r\n//       );\r\n//       setBalance(response.data.balance);\r\n//       console.log(\"Balance Data:\", response.data);\r\n//     } catch (error) {\r\n//       console.error(\"Error fetching balance:\", error);\r\n//     } finally {\r\n//       setRefreshing(false);\r\n//     }\r\n//   };\r\n\r\n//   const handelUserDetails = async (userId) => {\r\n//     const result = await UserAllDetails(userId);\r\n//     setBalance(result.data.user.balance);\r\n//   };\r\n\r\n//   return {\r\n//     balance,\r\n//     refreshing,\r\n//     handleRefresh,\r\n//     setBalance\r\n//   };\r\n// };\r\n\r\n\r\n\r\n// hooks/useRefreshBalance.js\r\nimport { useState, useEffect } from \"react\";\r\n\r\nimport { useAuth } from \"../contexts/AuthContext\";\r\n\r\nexport const useRefreshBalance = () => {\r\n  const [balance, setBalance] = useState(null);\r\n  const [refreshing, setRefreshing] = useState(false);\r\n  const { userDetails } = useAuth(); // ✅ fixed typo\r\n\r\n  // Sync initial balance from AuthContext\r\n  useEffect(() => {\r\n    if (userDetails?.balance !== undefined) {\r\n      setBalance(userDetails.balance);\r\n    }\r\n  }, [userDetails]);\r\n\r\n  // ✅ Refresh balance manually\r\n  const handleRefresh = async (userId) => {\r\n    if (!userId) return;\r\n    setRefreshing(true);\r\n\r\n    try {\r\n      // Optional: update local balance from user detail endpoint\r\n    //   await handleUserDetails(userId);\r\n\r\n      // Fetch latest balance directly\r\n      const response = await fetch(\"http://localhost:5000/api/v1/user_balance\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ userId }),\r\n      });\r\n\r\n      if (!response.ok) throw new Error(\"Network response was not ok\");\r\n\r\n      const data = await response.json();\r\n      if (data?.balance !== undefined) {\r\n        setBalance(data.balance);\r\n        console.log(\"Balance Data:\", data);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching balance:\", error);\r\n    } finally {\r\n      setRefreshing(false);\r\n    }\r\n  };\r\n\r\n  // ✅ Fetch user details balance\r\n//   const handleUserDetails = async (userId) => {\r\n//     try {\r\n//       const result = await UserAllDetails(userId); // assuming this still uses fetch or internal API call\r\n//       if (result?.data?.user?.balance !== undefined) {\r\n//         setBalance(result.data.user.balance);\r\n//       }\r\n//     } catch (err) {\r\n//       console.error(\"Error fetching user details:\", err);\r\n//     }\r\n//   };\r\n\r\n  return {\r\n    balance,\r\n    refreshing,\r\n    handleRefresh,\r\n    setBalance,\r\n  };\r\n};\r\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA,OAASA,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAE3C,OAASC,OAAO,KAAQ,yBAAyB,CAEjD,MAAO,MAAM,CAAAC,iBAAiB,CAAGA,CAAA,GAAM,CACrC,KAAM,CAACC,OAAO,CAAEC,UAAU,CAAC,CAAGL,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACM,UAAU,CAAEC,aAAa,CAAC,CAAGP,QAAQ,CAAC,KAAK,CAAC,CACnD,KAAM,CAAEQ,WAAY,CAAC,CAAGN,OAAO,CAAC,CAAC,CAAE;AAEnC;AACAD,SAAS,CAAC,IAAM,CACd,GAAI,CAAAO,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEJ,OAAO,IAAKK,SAAS,CAAE,CACtCJ,UAAU,CAACG,WAAW,CAACJ,OAAO,CAAC,CACjC,CACF,CAAC,CAAE,CAACI,WAAW,CAAC,CAAC,CAEjB;AACA,KAAM,CAAAE,aAAa,CAAG,KAAO,CAAAC,MAAM,EAAK,CACtC,GAAI,CAACA,MAAM,CAAE,OACbJ,aAAa,CAAC,IAAI,CAAC,CAEnB,GAAI,CACF;AACF;AAEE;AACA,KAAM,CAAAK,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,2CAA2C,CAAE,CACxEC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CAAEP,MAAO,CAAC,CACjC,CAAC,CAAC,CAEF,GAAI,CAACC,QAAQ,CAACO,EAAE,CAAE,KAAM,IAAI,CAAAC,KAAK,CAAC,6BAA6B,CAAC,CAEhE,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAT,QAAQ,CAACU,IAAI,CAAC,CAAC,CAClC,GAAI,CAAAD,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEjB,OAAO,IAAKK,SAAS,CAAE,CAC/BJ,UAAU,CAACgB,IAAI,CAACjB,OAAO,CAAC,CACxBmB,OAAO,CAACC,GAAG,CAAC,eAAe,CAAEH,IAAI,CAAC,CACpC,CACF,CAAE,MAAOI,KAAK,CAAE,CACdF,OAAO,CAACE,KAAK,CAAC,yBAAyB,CAAEA,KAAK,CAAC,CACjD,CAAC,OAAS,CACRlB,aAAa,CAAC,KAAK,CAAC,CACtB,CACF,CAAC,CAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEE,MAAO,CACLH,OAAO,CACPE,UAAU,CACVI,aAAa,CACbL,UACF,CAAC,CACH,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}