{"ast":null,"code":"import React,{useCallback,useEffect,useRef,useState}from'react';import PromotionInfo from'../member/PromotionPage/PromotionInfo';import{usePopup}from'../../hooks/usePopup';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default()=>{const images=[\"https://i.ibb.co.com/DChN5S5/img-1.jpg\",\"https://i.ibb.co.com/VqtD7Tq/img-2.jpg\",\"https://i.ibb.co.com/7Kkr63k/img-3.jpg\",\"https://i.ibb.co.com/LQB0VW7/img-4.jpg\",\"https://i.ibb.co.com/gdQVX9d/image-5.jpg\"];const marqueeRef=useRef(null);const intervalRef=useRef(null);const positionRef=useRef(0);const itemWidthRef=useRef(0);const[activeIndex,setActiveIndex]=useState(0);const{openPopup,closePopup}=usePopup();const handlePromoDetail=useCallback(promotion=>{openPopup(/*#__PURE__*/_jsx(PromotionInfo,{promotion:promotion// showSuccess={showSuccess}\n,onClose:()=>{}}),{contentClass:'promotionPop',size:'large'});},[openPopup]);const handlePromoAction=useCallback(promotion=>{handlePromoDetail(promotion);closePopup();},[handlePromoDetail]);useEffect(()=>{const marquee=marqueeRef.current;if(!marquee)return;const wrapper=marquee.querySelector('.item-wrap');const firstItem=wrapper.querySelector('.item');if(!firstItem)return;itemWidthRef.current=firstItem.offsetWidth;const moveSlider=()=>{positionRef.current-=itemWidthRef.current;if(Math.abs(positionRef.current)>=itemWidthRef.current*images.length){positionRef.current=0;wrapper.style.transition='none';wrapper.style.transform=\"translateX(\".concat(positionRef.current,\"px)\");void wrapper.offsetWidth;// Force reflow\n}wrapper.style.transition='transform 1s ease-in-out';wrapper.style.transform=\"translateX(\".concat(positionRef.current,\"px)\");// Calculate new active index\nconst step=Math.abs(positionRef.current)/itemWidthRef.current;const newIndex=Math.floor(step)%images.length;setActiveIndex(newIndex);};intervalRef.current=setInterval(moveSlider,5000);const handleResize=()=>{itemWidthRef.current=firstItem.offsetWidth;};window.addEventListener('resize',handleResize);return()=>{clearInterval(intervalRef.current);window.removeEventListener('resize',handleResize);};},[images.length]);return/*#__PURE__*/_jsx(\"div\",{className:\"banner\",children:/*#__PURE__*/_jsx(\"div\",{className:\"banner-v1\",ref:marqueeRef,children:/*#__PURE__*/_jsxs(\"div\",{className:\"carousel-wrap style-init mcd siblings\",\"data-auto\":\"true\",\"data-delay\":\"500\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"cdk-drag item-drag\",children:/*#__PURE__*/_jsx(\"div\",{className:\"item-left\",children:/*#__PURE__*/_jsx(\"div\",{className:\"item-wrap\",children:[...images,...images].map((url,idx)=>/*#__PURE__*/_jsx(\"div\",{className:\"item\",onClick:()=>handlePromoAction(url),children:/*#__PURE__*/_jsx(\"div\",{className:\"item-pic\",style:{backgroundImage:\"url(\\\"\".concat(url,\"\\\")\")}})},idx))})})}),/*#__PURE__*/_jsx(\"ul\",{className:\"dot-group style-bar\",children:images.map((_,idx)=>/*#__PURE__*/_jsx(\"li\",{className:\"\".concat(idx===activeIndex?\"active\":\"\"),children:/*#__PURE__*/_jsx(\"span\",{className:\"dot-progress\",style:{animationDuration:\"5000ms\"}},activeIndex)},idx))})]})})});};","map":{"version":3,"names":["React","useCallback","useEffect","useRef","useState","PromotionInfo","usePopup","jsx","_jsx","jsxs","_jsxs","images","marqueeRef","intervalRef","positionRef","itemWidthRef","activeIndex","setActiveIndex","openPopup","closePopup","handlePromoDetail","promotion","onClose","contentClass","size","handlePromoAction","marquee","current","wrapper","querySelector","firstItem","offsetWidth","moveSlider","Math","abs","length","style","transition","transform","concat","step","newIndex","floor","setInterval","handleResize","window","addEventListener","clearInterval","removeEventListener","className","children","ref","map","url","idx","onClick","backgroundImage","_","animationDuration"],"sources":["F:/png71/my-app/src/components/common/Carousel.js"],"sourcesContent":["import React, { useCallback, useEffect, useRef, useState } from 'react';\r\nimport PromotionInfo from '../member/PromotionPage/PromotionInfo';\r\nimport { usePopup } from '../../hooks/usePopup';\r\n\r\nexport default () => {\r\n  const images = [\r\n    \"https://i.ibb.co.com/DChN5S5/img-1.jpg\",\r\n    \"https://i.ibb.co.com/VqtD7Tq/img-2.jpg\",\r\n    \"https://i.ibb.co.com/7Kkr63k/img-3.jpg\",\r\n    \"https://i.ibb.co.com/LQB0VW7/img-4.jpg\",\r\n    \"https://i.ibb.co.com/gdQVX9d/image-5.jpg\",\r\n  ];\r\n\r\n  const marqueeRef = useRef(null);\r\n  const intervalRef = useRef(null);\r\n  const positionRef = useRef(0);\r\n  const itemWidthRef = useRef(0);\r\n  const [activeIndex, setActiveIndex] = useState(0);\r\n\r\n\r\n\r\n\r\n  const { openPopup, closePopup } = usePopup();\r\n\r\n  const handlePromoDetail = useCallback((promotion) => {\r\n    openPopup(\r\n      <PromotionInfo\r\n        promotion={promotion}\r\n        // showSuccess={showSuccess}\r\n        onClose={() => {}}\r\n      />,\r\n      { \r\n        contentClass: 'promotionPop',\r\n        size: 'large'\r\n      }\r\n    );\r\n  }, [openPopup]);\r\n\r\n  const handlePromoAction = useCallback((promotion) => {\r\n   \r\n      handlePromoDetail(promotion);\r\n      closePopup();\r\n  }, [handlePromoDetail]);\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    const marquee = marqueeRef.current;\r\n    if (!marquee) return;\r\n\r\n    const wrapper = marquee.querySelector('.item-wrap');\r\n    const firstItem = wrapper.querySelector('.item');\r\n    if (!firstItem) return;\r\n\r\n    itemWidthRef.current = firstItem.offsetWidth;\r\n    \r\n    const moveSlider = () => {\r\n      positionRef.current -= itemWidthRef.current;\r\n      \r\n      if (Math.abs(positionRef.current) >= itemWidthRef.current * images.length) {\r\n        positionRef.current = 0;\r\n        wrapper.style.transition = 'none';\r\n        wrapper.style.transform = `translateX(${positionRef.current}px)`;\r\n        void wrapper.offsetWidth; // Force reflow\r\n      }\r\n      \r\n      wrapper.style.transition = 'transform 1s ease-in-out';\r\n      wrapper.style.transform = `translateX(${positionRef.current}px)`;\r\n      \r\n      // Calculate new active index\r\n      const step = Math.abs(positionRef.current) / itemWidthRef.current;\r\n      const newIndex = Math.floor(step) % images.length;\r\n      setActiveIndex(newIndex);\r\n    };\r\n\r\n    intervalRef.current = setInterval(moveSlider, 5000);\r\n\r\n    const handleResize = () => {\r\n      itemWidthRef.current = firstItem.offsetWidth;\r\n    };\r\n\r\n    window.addEventListener('resize', handleResize);\r\n\r\n    return () => {\r\n      clearInterval(intervalRef.current);\r\n      window.removeEventListener('resize', handleResize);\r\n    };\r\n  }, [images.length]);\r\n\r\n  return (\r\n    <div className=\"banner\">\r\n      <div className=\"banner-v1\" ref={marqueeRef}>\r\n        <div className=\"carousel-wrap style-init mcd siblings\" data-auto=\"true\" data-delay=\"500\">\r\n          <div className=\"cdk-drag item-drag\">\r\n            <div className=\"item-left\">\r\n              <div className=\"item-wrap\">\r\n                {[...images, ...images].map((url, idx) => (\r\n                  <div key={idx} className=\"item\" onClick={() => handlePromoAction(url)}>\r\n                    <div\r\n                      className=\"item-pic\"\r\n                      style={{ backgroundImage: `url(\"${url}\")` }}\r\n                    />\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <ul className=\"dot-group style-bar\">\r\n            {images.map((_, idx) => (\r\n              <li key={idx} className={`${idx === activeIndex ? \"active\" : \"\"}`}>\r\n                {/* Key forces animation restart when active */}\r\n                <span \r\n                  key={activeIndex} \r\n                  className={\"dot-progress\"}\r\n                  style={{ animationDuration: \"5000ms\" }}\r\n                ></span>\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}